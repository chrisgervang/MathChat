actualKeys =
  192: '`'
  49: 1
  50: 2
  51: 3
  52: 4
  53: 5
  54: 6
  55: 7
  56: 8
  57: 9
  48: 0
  189: '-'
  187: '='
  8: 'delete'
  9: 'tab'
  81: 'q'
  87: 'w'
  69: 'e'
  82: 'r'
  84: 't'
  89: 'y'
  85: 'u'
  73: 'i'
  79: 'o'
  80: 'p'
  219: '['
  221: ']'
  220: '\\'
  20: 'caps'
  65: 'a'
  83: 's'
  68: 'd'
  70: 'f'
  71: 'g'
  72: 'h'
  74: 'j'
  75: 'k'
  76: 'l'
  186: ';'
  222: '\''
  13: 'return'
  16: 'shift'
  90: 'z'
  88: 'x'
  67: 'c'
  86: 'v'
  66: 'b'
  78: 'n'
  77: 'm'
  188: ','
  190: '.'
  191: '/'
  16: 'shift'
  999: 'fn'
  17: 'ctrl'
  18: 'opt'
  91: 'cmd'
  32: 'space'
  93: 'cmd'
  18: 'opt'
  37: '←'
  38: '↑'
  40: '↓'
  39: '→'

optable =
  Integral:
    MathML:"""
          <msubsup>
            <mo>&Integral;</mo>
            <mrow>
              <mo>&EmptyVerySmallSquare;</mo>
            </mrow>
            <mrow>
              <mo>&EmptyVerySmallSquare;</mo>
            </mrow>
          </msubsup>
          """
  Tilde:
    MathML:"<mo>~</mo>"
  NotEqual:
    MathML:"<mo>&NotEqual;</mo>"
  parallel:
    MathML:"<mo>&parallel;</mo>"
  Percent:
    MathML:"<mo>%</mo>"
  SquareRoot:
    MathML:"""
          <msqrt>
            <mrow>
              <mo>&square;</mo>
            </mrow>
          </msqrt>
          """
  PlusMinus:
    MathML:"<mo>&PlusMinus;</mo>"
  times:
    MathML:"<mo>&times;</mo>"
  minus:
    MathML:"<mo>-</mo>"
  equals:
    MathML:"<mo>=</mo>"
  log:
    MathML:"<mo>log</mo>"
  epsilon:
    MathML:"<mo>&epsilon;</mo>"
  Union:
    MathML:"""
            <munderover>
              <mo>&Union;</mo>
              <mrow>
                <mo>&EmptyVerySmallSquare;</mo>
              </mrow>
              <mrow>
                <mo>&EmptyVerySmallSquare;</mo>
              </mrow>
            </munderover>
          """
  dx:
    MathML:"<mo>d<mi>x</mi></mo>"
  Product:
    MathML:"""
          <munderover>
            <mo>&Product;</mo>
            <mrow>
              <mo>&EmptyVerySmallSquare;</mo>
            </mrow>
            <mrow>
              <mo>&EmptyVerySmallSquare;</mo>
            </mrow>
          </munderover>
          """
  leftBracket:
    MathML:"<mo>[</mo>"
  rightBracket:
    MathML:"<mo>]</mo>"
  logicalAnd:
    MathML:"<mo>&and;</mo>"
  toggleKeyboard:
    MathML:"<mo>&#9000;</mo>"
  Sum:
    MathML:"""
          <munderover>
            <mo>&Sum;</mo>
            <mrow>
              <mo>&EmptyVerySmallSquare;</mo>
            </mrow>
            <mrow>
              <mo>&EmptyVerySmallSquare;</mo>
            </mrow>
          </munderover>
          """
  Delta:
    MathML:"<mo>&Delta;</mo>"
  MathFunction:
    MathML:"<mo>&#x192;</mo>"
  sin:
    MathML:"<mo>sin</mo>"
  cos:
    MathML:"<mo>cos</mo>"
  tan:
    MathML:"<mo>tan</mo>"
  lambda:
    MathML:"<mo>&lambda;</mo>"
  pi:
    MathML:"<mo>&pi;</mo>"
  langle:
    MathML:"<mo>&langle;</mo>"
  superScript:
    MathML:"""
            <msup>
              <mo>sup</mo>
              <mrow>
                <mo>x</mo>
              </mrow>
            </msup>
          """
  ForAll:
    MathML:"<mo>&ForAll;</mo>"
  Exists:
    MathML:"<mo>&Exists;</mo>"
  in:
    MathML:"<mo>&in;</mo>"
  lessThan:
    MathML:"<mo><</mo>"
  greaterThan:
    MathML:"<mo>></mo>"
  divide:
    MathML:"<mo>&divide;</mo>"
  backspace:
    MathML:"<mo>&#9003;</mo>"
  rarr:
    MathML:"<mo>&rarr;</mo>"
  larr:
    MathML:"<mo>&larr;</mo>"
  uarr:
    MathML:"<mo>&uarr;</mo>"
  darr:
    MathML:"<mo>&darr;</mo>"
  Not:
    MathML:"<mo>!</mo>"
  approx:
    MathML:"<mo>&approx;</mo>"
  TildeFullEqual:
    MathML:"<mo>&TildeFullEqual;</mo>"
  nparallel:
    MathML:"<mo>&nparallel;</mo>"
  AnyRoot:
    MathML:"""
          <mroot>
            <mrow>
              <mo>&square;</mo>
            </mrow>
            <mrow>
              <mo>&EmptyVerySmallSquare;</mo>
            </mrow>
          </mroot>
          """
  openParen:
    MathML:"<mo>(</mo>"
  closeParen:
    MathML:"<mo>)</mo>"
  plus:
    MathML:"<mo>+</mo>"
  ln:
    MathML:"<mo>ln</mo>"
  emptyset:
    MathML:"<mo>&emptyset;</mo>"
  eulersConst:
    MathML:"<mo><mi>e</mi></mo>"
  Intersection:
    MathML:"""
          <munderover>
            <mo>&Intersection;</mo>
              <mrow>
                <mo>&EmptyVerySmallSquare;</mo>
              </mrow>
              <mrow>
                <mo>&EmptyVerySmallSquare;</mo>
              </mrow>
          </munderover>
          """
  DoubleIntegral:
    MathML:"""
          <msubsup>
            <mo>&Integral;&Integral;</mo>
            <mrow>
              <mo>&EmptyVerySmallSquare;</mo>
            </mrow>
            <mrow>
              <mo>&EmptyVerySmallSquare;</mo>
            </mrow>
          </msubsup>
          """
  dtheta:
    MathML:"<mo>d<mi>&theta;</mi></mo>"
  CircleTimes:
    MathML:"<mo>&CircleTimes;</mo>"
  CirclePlus:
    MathML:"<mo>&CirclePlus;</mo>"
  leftCurly:
    MathML:"<mo>{</mo>"
  rightCurly:
    MathML:"<mo>}</mo>"
  logicalOr:
    MathML:"<mo>&or;</mo>"
  PartialD:
    MathML:"<mo>&PartialD;</mo>"
  Infinity:
    MathML:"<mo>&#x221E;</mo>"
  csc:
    MathML:"<mo>csc</mo>"
  sec:
    MathML:"<mo>sec</mo>"
  cot:
    MathML:"<mo>cot</mo>"
  range:
    MathML:"""
          <mover>
            <mrow>
              <mo>&Square;</mo>
            </mrow>
            <mo>&#x308;</mo>
          </mover>
          """
  lessThanOrEqual:
    MathML:"<mo>&leq;</mo>"
  greaterThanOrEqual:
    MathML:"<mo>&geq;</mo>"
  fraction:
    MathML:"""
          <mfrac>
            <mrow>
              <mo>&Square;</mo>
            </mrow>
            <mrow>
              <mo>&Square;</mo>
            </mrow>
          </mfrac>
          """


Ctrl.define
  'key':
    ready: ->

      @autorun =>
        if @api.isPressed()
          $(".key-#{@api.code()}").addClass('-pressed')
        else
          $(".key-#{@api.code()}").removeClass('-pressed')

    api:
      isPressed: (value) -> @prop 'isPressed', value, default:false

      code: (value) -> @prop 'code', value
      func: (value) -> @prop 'func', value

    helpers:
      actual: -> actualKeys[@api.code()]
      symbol: -> optable[@api.func()]?.MathML

      modifiers: ->
        classes = ""
        # classes += "-pressed" if @api.isPressed()
        classes
